<!doctype html>
<html lang="en">
<head>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />

	<title>Vanta Proxy</title>
	<meta name="description" content="Vanta" />

	<link rel="icon" href="/favicon.ico" />
	<link rel="stylesheet" href="index.css" />

	<!-- Panic (global, works on all pages) -->
	<script src="panic.js"></script>

	<!-- Core proxy scripts -->
	<script src="/scram/scramjet.all.js" defer></script>
	<script src="baremux/index.js" defer></script>
	<script src="epoxy/index.js" defer></script>
	<script src="register-sw.js" defer></script>
	<script src="search.js" defer></script>
	<script src="index.js" defer></script>

	<script>
		/* =========================
		   Settings + About:Blank
		========================= */
		const SETTINGS_KEY = "vanta_settings";

		function loadSettings() {
			return JSON.parse(localStorage.getItem(SETTINGS_KEY)) || {
				aboutBlank: true,
				cloakTitle: "Vanta Proxy"
			};
		}

		function openAboutBlank(url, title) {
			const win = window.open("", "_blank", "width=1280,height=720");
			if (!win) return;

			win.document.write(`
				<!doctype html>
				<html>
				<head>
					<title>${title}</title>
					<style>
						html, body {
							margin: 0;
							width: 100%;
							height: 100%;
							background: #111;
							overflow: hidden;
						}
						iframe {
							width: 100%;
							height: 100%;
							border: none;
						}
					</style>
				</head>
				<body>
					<iframe src="${url}"></iframe>
				</body>
				</html>
			`);
			win.document.close();
		}

		window.addEventListener("DOMContentLoaded", () => {
			const settings = loadSettings();
			const flag = "VANTA_AB_OPENED";

			if (settings.aboutBlank && !sessionStorage.getItem(flag)) {
				setTimeout(() => {
					openAboutBlank(location.origin, settings.cloakTitle);
					sessionStorage.setItem(flag, "1");
				}, 150);
			}
		});
	</script>

	<style>
		/* Loader advanced styling */
		#loader {
			position: fixed;
			inset: 0;
			display: flex;
			justify-content: center;
			align-items: center;
			background: linear-gradient(180deg, #000, #1e4fff);
			z-index: 9999;
			transition: opacity 0.6s ease;
		}

		.loader-box {
			display: flex;
			flex-direction: column;
			align-items: center;
			gap: 20px;
			text-align: center;
		}

		.loader-logo {
			height: 18vh;
			max-height: 100px;
			animation: pulse 1.5s infinite alternate;
		}

		@keyframes pulse {
			0% { transform: scale(1); opacity: 1; }
			100% { transform: scale(1.05); opacity: 0.85; }
		}

		.progress {
			width: 260px;
			max-width: 80vw;
			height: 6px;
			background: rgba(255,255,255,0.25);
			border-radius: 8px;
			overflow: hidden;
		}

		.progress-bar {
			height: 100%;
			width: 1%;
			background: white;
			transition: width 0.2s ease-out;
			border-radius: 8px;
		}

		.percent {
			font-size: 13px;
			opacity: 0.75;
			font-weight: 500;
		}
	</style>
</head>

<body>

	<!-- Loading Screen -->
	<div id="loader">
		<div class="loader-box">
			<img src="sj.png" alt="Vanta Logo" class="loader-logo" />
			<div class="progress">
				<div class="progress-bar" id="progress-bar"></div>
			</div>
			<div class="percent" id="percent">0%</div>
		</div>
	</div>

	<!-- App -->
	<div id="app">
		<main class="main">
			<!-- Logo sits directly above the tagline -->
			<img src="sj.png" alt="Vanta logo" class="logo" />

			<p class="tagline" id="random-quote"></p>

			<form id="sj-form" class="search-box" role="search">
				<input
					id="sj-search-engine"
					type="hidden"
					value="https://www.google.com/search?q=%s"
				/>

				<input
					id="sj-address"
					type="text"
					autocomplete="off"
					spellcheck="false"
					placeholder="Search or enter a URL"
				/>

				<button type="submit" class="icon-btn" title="Search">üîç</button>
			</form>

			<p id="sj-error" class="error"></p>
			<pre id="sj-error-code" class="error-code"></pre>
		</main>

		<footer class="footer">
  			<a href="index.html">Back</a>
		</footer>

	</div>

	<script>
		/* ===== Loader with advanced easing ===== */
		let progress = 0;
		const bar = document.getElementById("progress-bar");
		const percent = document.getElementById("percent");
		const loader = document.getElementById("loader");
		const app = document.getElementById("app");

		function ease(current, target, speed = 0.05) {
			return current + (target - current) * speed;
		}

		let targetProgress = 0;

		const tick = setInterval(() => {
			if (targetProgress < 100) targetProgress += Math.random() * 2;

			progress = ease(progress, targetProgress);
			if (progress > 100) progress = 100;

			bar.style.width = progress + "%";
			percent.textContent = Math.floor(progress) + "%";

			if (progress >= 99.9) {
				clearInterval(tick);
				setTimeout(() => {
					loader.style.opacity = "0";
					app.style.opacity = "1";
					setTimeout(() => loader.remove(), 600);
				}, 250);
			}
		}, 20);

		/* ===== Random Quotes ===== */
		const quotes = [
			"best proxy oat.",
			"they blocked it, we unblocked it",
			"speed, privacy, freedom",
			"vanta",
			"who's your favorite teacher?",
			"school work? never heard of it",
			"vanta is the easiest and safest proxy",
			"fast, clean, unstoppable.",
			"did you know vanta was made by a dweeb that goes by the name of exvinixty?"
		];

		document.getElementById("random-quote").textContent =
			quotes[Math.floor(Math.random() * quotes.length)];
	</script>

</body>
</html>
